--EXPERIMENT 1--
--EASY PROBLEM--

CREATE TABLE AUTHORS_DATA(
AUTHOR_ID INT PRIMARY KEY IDENTITY(1,1),AUTHOR_NAME VARCHAR(20),AUTHOR_COUNTRY VARCHAR(30)
);
INSERT INTO AUTHORS_DATA(AUTHOR_NAME,AUTHOR_COUNTRY) VALUES('CHETAN BHAGAT','INDIA');
INSERT INTO AUTHORS_DATA(AUTHOR_NAME,AUTHOR_COUNTRY) VALUES('HARUKI MURAKAMI','JAPAN');
INSERT INTO AUTHORS_DATA(AUTHOR_NAME,AUTHOR_COUNTRY) VALUES('YANN MARTEL','CANADA');

CREATE TABLE BOOKS_DATA(
BOOK_ID INT PRIMARY KEY, BOOK_TITLE VARCHAR(20),AUTHORID INT,
FOREIGN KEY (AUTHORID) REFERENCES AUTHORS_DATA(AUTHOR_ID)
);
INSERT INTO BOOKS_DATA(AUTHORID,BOOK_ID,BOOK_TITLE) VALUES (1,101,'FIVE POINT SOMEONE');
INSERT INTO BOOKS_DATA(AUTHORID,BOOK_ID,BOOK_TITLE) VALUES (1,102,'2 STATES');
INSERT INTO BOOKS_DATA(AUTHORID,BOOK_ID,BOOK_TITLE) VALUES (2,103,'NORWEGIAN WOOD');
INSERT INTO BOOKS_DATA(AUTHORID,BOOK_ID,BOOK_TITLE) VALUES (3,104,'LIFE OF PI');
INSERT INTO BOOKS_DATA(AUTHORID,BOOK_ID,BOOK_TITLE) VALUES (2,105,'KAFKA ON THE SHORE');

SELECT * FROM AUTHORS_DATA
SELECT * FROM BOOKS_DATA
SELECT B.BOOK_TITLE AS [BOOK TITLE],A.AUTHOR_NAME AS [AUTHOR NAME],A.AUTHOR_COUNTRY AS [AUTHOR COUNTRY]
FROM AUTHORS_DATA AS A 
INNER JOIN
BOOKS_DATA AS B
ON
A.AUTHOR_ID=B.AUTHORID


--EXPERIMENT 1--
--MEDIUM PROBLEM--

CREATE TABLE DEPARTMENT(
DEPT_ID INT PRIMARY KEY IDENTITY(1,1),DEPT_NAME VARCHAR(MAX)
);
INSERT INTO DEPARTMENT(DEPT_NAME) VALUES ('COMPUTER SCIENCE')
INSERT INTO DEPARTMENT(DEPT_NAME) VALUES ('MATHEMATICS')
INSERT INTO DEPARTMENT(DEPT_NAME) VALUES ('PHYSICS')
INSERT INTO DEPARTMENT(DEPT_NAME) VALUES ('HISTORY')
INSERT INTO DEPARTMENT(DEPT_NAME) VALUES ('PSHYCHOLOGY')

CREATE TABLE COURSES(
 COURSE_ID INT IDENTITY(101,1),COURSE_NAME VARCHAR(MAX),DEPTID INT,FOREIGN KEY (DEPTID) REFERENCES DEPARTMENT(DEPT_ID)
);

INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('DATA STRUCTURES',1)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('OPERATING SYSTEMS',1)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('DATABASE SYSTEMS',1)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('CALCULUS',2)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('LINEAR ALGEBRA',2)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('QUANTUM MECHANICS',3)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('OPTICS',3)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('MODERN HISTORY',4)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('ANCIENT HISTORY',4)
INSERT INTO COURSES(COURSE_NAME,DEPTID) VALUES('COGNITIVE PSHYCHOLOGY',5)
SELECT * FROM DEPARTMENT;
SELECT * FROM COURSES;

SELECT D.DEPT_NAME,COUNT(C.COURSE_ID) AS [NUMBER OF COURSES]
FROM DEPARTMENT AS D
INNER JOIN
COURSES AS C
ON D.DEPT_ID=C.DEPTID
GROUP BY D.DEPT_NAME

SELECT DEPT_NAME
FROM DEPARTMENT
WHERE DEPT_ID IN
(
SELECT DEPTID
FROM COURSES GROUP BY DEPTID HAVING COUNT(*)>2
)

